"use strict";const e=require("./common/vendor.js"),a=require("./static/js/utils.js");if(!Array){(e.resolveComponent("nut-form-item")+e.resolveComponent("nut-button")+e.resolveComponent("nut-form"))()}Math||((()=>"./uni_modules/sky-nutui/components/sky-nutui/packages/__VUE/formitem/index.js")+(()=>"./uni_modules/sky-nutui/components/sky-nutui/packages/__VUE/button/index.js")+(()=>"./uni_modules/sky-nutui/components/sky-nutui/packages/__VUE/form/index.js"))();const u={__name:"Appointment",setup(u){var t=[],l=0;e.onReady((()=>{a.useGlobal.getMeetList((function(e){let a=["请选择"];for(let u of e.values())a.push(u.mName),t.push(u.ID);o.value=a}))}));const n=e.ref(0),o=e.ref([]),i=e=>{l=t[e.detail.value-1],n.value=e.detail.value},s=a.useGlobal.getDate({format:!0}),r=e.ref(a.useGlobal.getDate()),v=e.ref(a.useGlobal.getDate("end")),d=e.ref(s),m=e.ref(a.useGlobal.getTime()),f=e.ref(a.useGlobal.getTime());function c(e){d.value=e.detail.value}function p(e){m.value=e.detail.value}function b(e){f.value=e.detail.value}let g=e.ref("暂无"),k=e.ref(1);function _(){if(e.index.showLoading({title:"请稍候"}),l<=0)return h("请选择会议室");if("00:00"==f.value||f.value<=m.value)return h("请重新选择结束时间");var u={meetId:l,userId:a.useGlobal.getCache("user").ID,startDate:d.value,startTime:+new Date(d.value+" "+m.value),endTime:+new Date(d.value+" "+f.value),number:k.value,remark:g.value};let t={url:a.useGlobal.serverUrl+a.useGlobal.apiPath.makeMeet,data:u,success:a=>{e.index.hideLoading(),1!=a.data.Code?e.index.showToast({title:a.data.Msg,icon:"none"}):e.index.showToast({title:"预定成功",icon:"success"})}};e.index.request(t)}function h(a=""){e.index.hideLoading(),e.index.showToast({title:a,icon:"none"})}return(a,u)=>({a:e.t(o.value[n.value]),b:n.value,c:o.value,d:e.o(i),e:e.p({label:"会议室",required:!0}),f:e.t(d.value),g:d.value,h:r.value,i:v.value,j:e.o(c),k:e.p({label:"预约日期",required:!0}),l:e.t(m.value),m:m.value,n:e.o(p),o:e.p({label:"开始时间",required:!0}),p:e.t(f.value),q:f.value,r:e.o(b),s:e.p({label:"结束时间",required:!0}),t:e.unref(k),v:e.o((a=>e.isRef(k)?k.value=a.detail.value:k=a.detail.value)),w:e.p({label:"参会人数",prop:"attendance",required:!0,rules:[{required:!0,message:"请填写人数"}]}),x:e.unref(g),y:e.o((a=>e.isRef(g)?g.value=a.detail.value:g=a.detail.value)),z:e.p({label:"备注",prop:"remark",required:!0}),A:e.o(_),B:e.p({block:!0,type:"primary"})})}};exports._sfc_main=u;
